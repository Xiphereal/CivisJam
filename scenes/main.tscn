[gd_scene load_steps=31 format=3 uid="uid://cfjit7ema1pr0"]

[ext_resource type="Texture2D" uid="uid://cr68f5ycxecim" path="res://art/BackgroundGameplay.png" id="1_5j8mf"]
[ext_resource type="Script" path="res://scenes/key.gd" id="1_flnan"]
[ext_resource type="Texture2D" uid="uid://eqrn27lxbokj" path="res://art/player.png" id="1_kboov"]
[ext_resource type="Script" path="res://scenes/suddent_pull_timer.gd" id="1_psoe2"]
[ext_resource type="Texture2D" uid="uid://p26qyddk35y6" path="res://art/boss.png" id="2_0aigi"]
[ext_resource type="Script" path="res://scenes/screen_shake.gd" id="2_c2w7v"]
[ext_resource type="Texture2D" uid="uid://n6b8osfvau3m" path="res://art/hoja1.png" id="2_yu4ut"]
[ext_resource type="Texture2D" uid="uid://qmspi2ul8hls" path="res://art/Vase.png" id="3_0x5h4"]
[ext_resource type="Texture2D" uid="uid://bdgc0c7xpnf62" path="res://art/Foreground.png" id="3_4tilt"]
[ext_resource type="AudioStream" uid="uid://l6lntkmm5vy5" path="res://audio/BOSS FIGHT.wav" id="3_5jvhv"]
[ext_resource type="Texture2D" uid="uid://ce71up5nhrn8n" path="res://art/rope.png" id="3_kwbbp"]
[ext_resource type="Texture2D" uid="uid://5o8miop8gg2g" path="res://art/keys.png" id="5_ecji2"]
[ext_resource type="Script" path="res://scenes/hold_bar.gd" id="9_yf12d"]
[ext_resource type="Script" path="res://scenes/boss_exhaust.gd" id="10_qfkqb"]
[ext_resource type="Script" path="res://scenes/sudden_pull.gd" id="10_s7g2n"]
[ext_resource type="Script" path="res://scenes/did_i_win_or_lose.gd" id="13_tykf0"]

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_fa1x2"]
particle_flag_disable_z = true
emission_shape = 3
emission_box_extents = Vector3(1500, 1, 1)
angle_min = -283.7
angle_max = 720.0
direction = Vector3(0, 1, 0)
spread = 2.022
initial_velocity_max = 50.0
gravity = Vector3(0, 70, 0)
scale_min = 0.01
scale_max = 0.1

[sub_resource type="RectangleShape2D" id="RectangleShape2D_t7n2f"]
size = Vector2(20, 54)

[sub_resource type="Animation" id="Animation_rb430"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("PlayerSprite:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(12.963, 5.367)]
}

[sub_resource type="Animation" id="Animation_c6sqw"]
resource_name = "pull"
length = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("PlayerSprite:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.466667),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(12.963, 5.367), Vector2(-27.2037, 5.44075)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_dpg0i"]
_data = {
"RESET": SubResource("Animation_rb430"),
"pull": SubResource("Animation_c6sqw")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_tutl4"]
size = Vector2(56.518, 584)

[sub_resource type="Animation" id="Animation_auxwn"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2DBoss:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}

[sub_resource type="Animation" id="Animation_0ebb0"]
resource_name = "idle"
length = 1.5
loop_mode = 2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2DBoss:rotation")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1.46667),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.0, 0.164001]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_gf0cc"]
_data = {
"RESET": SubResource("Animation_auxwn"),
"idle": SubResource("Animation_0ebb0")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_f0lun"]
size = Vector2(172.807, 645.175)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_0cplf"]
bg_color = Color(1.58831e-06, 0.727682, 0.0957549, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_psvvm"]
bg_color = Color(0.741176, 0.721569, 0.0470588, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_sb71a"]
bg_color = Color(0.905269, 2.38247e-06, 1.92523e-07, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_2n2sf"]
bg_color = Color(0.739412, 0.721203, 0.0451093, 1)

[node name="Node2D" type="Node2D"]

[node name="Environment" type="Node2D" parent="."]

[node name="Background" type="Sprite2D" parent="Environment"]
z_index = -1
scale = Vector2(0.516667, 0.516667)
texture = ExtResource("1_5j8mf")

[node name="FallingObjecs" type="GPUParticles2D" parent="Environment"]
z_index = -1
position = Vector2(-782, -1748)
amount = 75
process_material = SubResource("ParticleProcessMaterial_fa1x2")
texture = ExtResource("2_yu4ut")
lifetime = 8.0
visibility_rect = Rect2(-2322.7, -841.658, 4638.97, 4600.25)

[node name="FallingObjecs2" type="GPUParticles2D" parent="Environment"]
z_index = -1
position = Vector2(-782, -1748)
amount = 75
process_material = SubResource("ParticleProcessMaterial_fa1x2")
texture = ExtResource("3_0x5h4")
lifetime = 8.0
visibility_rect = Rect2(-2322.7, -841.658, 4638.97, 4600.25)

[node name="Foreground" type="Sprite2D" parent="Environment"]
scale = Vector2(0.517, 0.517)
texture = ExtResource("3_4tilt")

[node name="Camera" type="Camera2D" parent="."]
unique_name_in_owner = true
ignore_rotation = false
script = ExtResource("2_c2w7v")
max_offset = Vector2(15, 8)
max_roll = 0.01

[node name="Key" type="Node2D" parent="."]
unique_name_in_owner = true
position = Vector2(-48, 257)
scale = Vector2(3.10714, 3.10714)
script = ExtResource("1_flnan")
player_pull_force = 30
boss_pull_force_based_on_distance = 0.08
metadata/_edit_group_ = true

[node name="Sprite2D" type="Sprite2D" parent="Key"]
scale = Vector2(0.05, 0.05)
texture = ExtResource("5_ecji2")

[node name="Area2D" type="Area2D" parent="Key"]

[node name="CollisionShape2D" type="CollisionShape2D" parent="Key/Area2D"]
shape = SubResource("RectangleShape2D_t7n2f")

[node name="Rope" type="Node2D" parent="."]
position = Vector2(0, 198)
scale = Vector2(0.23, 0.23)

[node name="Sprite" type="Sprite2D" parent="Rope"]
position = Vector2(-800.004, -18.75)
scale = Vector2(2.66147, 0.975003)
texture = ExtResource("3_kwbbp")

[node name="Player" type="Node2D" parent="."]
position = Vector2(-778, 249)
scale = Vector2(2.20558, 2.20558)
metadata/_edit_group_ = true

[node name="PlayerSprite" type="Sprite2D" parent="Player"]
unique_name_in_owner = true
position = Vector2(12.963, 5.367)
scale = Vector2(0.1, 0.1)
texture = ExtResource("1_kboov")

[node name="AnimationPlayer" type="AnimationPlayer" parent="Player"]
libraries = {
"": SubResource("AnimationLibrary_dpg0i")
}
next/pull = &"RESET"

[node name="WinArea" type="Area2D" parent="Player"]
position = Vector2(-75, 12)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Player/WinArea"]
position = Vector2(88, -38)
shape = SubResource("RectangleShape2D_tutl4")

[node name="StaminaBoost" type="Timer" parent="Player"]
autostart = true

[node name="Boss" type="Node2D" parent="."]
unique_name_in_owner = true
position = Vector2(618, 241)
scale = Vector2(2.28, 2.28)
metadata/_edit_group_ = true

[node name="Money" type="GPUParticles2D" parent="Boss"]
z_index = -1
position = Vector2(-614.035, -872.368)
scale = Vector2(0.438596, 0.438596)
amount = 150
process_material = SubResource("ParticleProcessMaterial_fa1x2")
texture = ExtResource("2_yu4ut")
lifetime = 8.0
visibility_rect = Rect2(-2322.7, -841.658, 4638.97, 4600.25)

[node name="Sprite2DBoss" type="Sprite2D" parent="Boss"]
position = Vector2(-111.842, -17.1053)
scale = Vector2(0.25, 0.25)
texture = ExtResource("2_0aigi")
offset = Vector2(447.368, 68.4211)

[node name="AnimationPlayer" type="AnimationPlayer" parent="Boss"]
libraries = {
"": SubResource("AnimationLibrary_gf0cc")
}
autoplay = "idle"

[node name="DefeatArea" type="Area2D" parent="Boss"]
position = Vector2(-87, 25)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Boss/DefeatArea"]
position = Vector2(79.1053, -57.2368)
shape = SubResource("RectangleShape2D_f0lun")

[node name="SuddentPull" type="Timer" parent="Boss"]
unique_name_in_owner = true
autostart = true
script = ExtResource("1_psoe2")
min_force = 50
max_force = 75

[node name="BossExhaust" type="Timer" parent="Boss"]
unique_name_in_owner = true
wait_time = 15.0
one_shot = true
autostart = true

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="Control" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 4
size_flags_vertical = 4

[node name="Stamina" type="ProgressBar" parent="CanvasLayer/Control"]
unique_name_in_owner = true
custom_minimum_size = Vector2(50, 0)
layout_mode = 0
offset_right = 357.0
offset_bottom = 59.0
theme_override_styles/fill = SubResource("StyleBoxFlat_0cplf")
value = 50.0
show_percentage = false

[node name="HoldBar" type="ProgressBar" parent="CanvasLayer/Control"]
unique_name_in_owner = true
custom_minimum_size = Vector2(50, 0)
layout_mode = 0
offset_top = 72.0
offset_right = 357.0
offset_bottom = 131.0
theme_override_styles/fill = SubResource("StyleBoxFlat_psvvm")
value = 50.0
show_percentage = false
script = ExtResource("9_yf12d")

[node name="BossExhaust" type="ProgressBar" parent="CanvasLayer/Control"]
custom_minimum_size = Vector2(50, 0)
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -357.0
offset_bottom = 59.0
grow_horizontal = 0
theme_override_styles/fill = SubResource("StyleBoxFlat_sb71a")
value = 50.0
show_percentage = false
script = ExtResource("10_qfkqb")

[node name="SuddenPull" type="ProgressBar" parent="CanvasLayer/Control"]
custom_minimum_size = Vector2(50, 0)
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -357.0
offset_top = 76.0
offset_bottom = 135.0
grow_horizontal = 0
theme_override_styles/fill = SubResource("StyleBoxFlat_2n2sf")
max_value = 4.0
value = 4.0
show_percentage = false
script = ExtResource("10_s7g2n")

[node name="DidIWinOrLose" type="Button" parent="CanvasLayer/Control"]
unique_name_in_owner = true
visible = false
layout_mode = 1
anchors_preset = -1
anchor_left = 0.00520833
anchor_top = -0.00925926
anchor_right = 1.00521
anchor_bottom = 0.990741
offset_left = -10.0
offset_top = 10.0
offset_right = -2.00012
offset_bottom = 18.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("13_tykf0")
metadata/_edit_use_anchors_ = true

[node name="Music" type="AudioStreamPlayer" parent="."]
unique_name_in_owner = true
stream = ExtResource("3_5jvhv")
autoplay = true

[node name="SFX" type="AudioStreamPlayer" parent="."]
unique_name_in_owner = true
volume_db = -10.0

[connection signal="area_entered" from="Player/WinArea" to="Key" method="_on_win"]
[connection signal="timeout" from="Player/StaminaBoost" to="Key" method="_on_stamina_boost_timeout"]
[connection signal="area_entered" from="Boss/DefeatArea" to="Key" method="_on_defeat"]
[connection signal="timeout" from="Boss/SuddentPull" to="Boss/SuddentPull" method="_on_timeout"]
[connection signal="timeout" from="Boss/BossExhaust" to="Key" method="_on_boss_force_loss_timeout"]
[connection signal="pressed" from="CanvasLayer/Control/DidIWinOrLose" to="CanvasLayer/Control/DidIWinOrLose" method="_on_pressed"]
